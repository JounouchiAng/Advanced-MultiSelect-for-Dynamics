var AdvancedMultiSelect=window.AdvancedMultiSelect||{__namespace:!0};AdvancedMultiSelect.ItemSetConfiguration=AdvancedMultiSelect.ItemSetConfiguration||{__namespace:!0};AdvancedMultiSelect.ItemSetConfiguration.Import=function(){var n=function(){var t,n=this,i=!1;n.IsReadyForImport=ko.observable(!1);n.IsImportInProgress=ko.observable(!1);n.ErrorMessage=ko.observable("");n.FileUpload=function(r,u){n.IsReadyForImport(!1);var e=u.target.files[0],f=new FileReader;f.onloadend=function(){t=f.result;n.IsReadyForImport(!0);i||(i=!0,u.target.onclick=n.OnClick)};e&&f.readAsText(e)};n.OnClick=function(n){n.target.value=""};n.Import=function(){if(!t){alert("There is no content found in the file.");return}var i={Configuration:t};n.IsImportInProgress(!0);CrmWebApiFacade.ExecuteAction("pavelkh_ItemSetConfigurationImport",i).then(function(t){n.IsImportInProgress(!1);var i=t.Errors;n.ErrorMessage(i);try{i?(alert("Error(s) occured while importing configuration. Please review the details."),window.opener.location.reload()):(alert("Import completed successfully."),window.opener.location.reload(),window.close())}catch(r){}},function(t){n.IsImportInProgress(!1);alert("\nDetails: "+t.message)})};n.Close=function(){try{window.close()}catch(n){}}};return{ViewModel:n}}();