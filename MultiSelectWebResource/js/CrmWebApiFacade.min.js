window.CrmWebApiFacade=function(){function u(){if(n===null)if(typeof GetGlobalContext!="undefined")n=window.GetGlobalContext();else if(typeof Xrm!="undefined")n=window.Xrm.Page.context;else if(typeof window.parent.Xrm!="undefined")n=window.parent.Xrm.Page.context;else throw new Error("Context is not available.");return n}function i(){if(t===null){var n,r=window.location.protocol+"//"+window.location.host,i=u();i.getClientUrl!==undefined?n=i.getClientUrl():i.isOutlookClient()&&!i.isOutlookOnline()?n=r:(n=i.getServerUrl(),n=n.replace(/^(http|https):\/\/([_a-zA-Z0-9\-\.]+)(:([0-9]{1,5}))?/,r),n=n.replace(/\/$/,""));t=n}return t}function f(){return i()+r}function e(n,t,i){var r=f()+n;return i=i===!1?!1:!0,xrmjQuery.ajax({type:"POST",contentType:"application/json; charset=utf-8",datatype:"json",async:i,data:window.JSON.stringify(t),url:r,headers:{Accept:"application/json","Content-Type":"application/json; charset=utf-8","OData-MaxVersion":"4.0","OData-Version":"4.0"}})}var r="/api/data/v8.1/",n=null,t=null,o=function(n,t,i){var r=xrmjQuery.Deferred();return e(n,t,i).then(function(n){r.resolve(n)},function(n){var t=JSON.parse(n.responseText),i={response:n,status:n.status,message:t.error.message};r.reject(i)}),r.promise()};return{ExecuteAction:o,GetServerUrl:i}}();